<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tile Maps • tilemaps</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tile Maps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tilemaps</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tilemaps.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kaerosen/tilemaps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tile Maps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kaerosen/tilemaps/blob/v0.2.1/vignettes/tilemaps.Rmd" class="external-link"><code>vignettes/tilemaps.Rmd</code></a></small>
      <div class="d-none name"><code>tilemaps.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kaerosen.github.io/tilemaps/" class="external-link">tilemaps</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-is-a-tile-map">What is a Tile Map?<a class="anchor" aria-label="anchor" href="#what-is-a-tile-map"></a>
</h2>
<p>A tile map is a map in which each region is represented by a single
tile of the same shape and size. For example, a square tile map of the
United States would consist of square tiles of the same size for each
state, regardless of the geographic area of each state. When creating a
tile map, the goal is to arrange tiles in a manner that preserves local
relationships between regions, as well as the overall shape of the
original map. Using a tile map is advantageous when trying to visualize
data where the importance of a region does not depend on the geographic
area of the region. Tile maps prevent regions with large areas from
dominating a map and prevent regions with small areas from going
unnoticed. The <code>tilemaps</code> package implements an algorithm for
creating tile maps that was proposed by Graham McNeill and Scott Hale in
the paper <em>“Generating Tile Maps”</em> (2017). The package allows the
user to generate a single tile map or many tile maps, which can be
compared by using cost functions or by plotting the maps.</p>
</div>
<div class="section level2">
<h2 id="creating-a-single-tile-map">Creating a Single Tile Map<a class="anchor" aria-label="anchor" href="#creating-a-single-tile-map"></a>
</h2>
<p>To create a single tile map, the <code><a href="../reference/generate_map.html">generate_map()</a></code> function
can be used. In the following example, a tile map with flat-topped
hexagons is generated for the contiguous United States using the
<code>governors</code> dataset, which is part of the
<code>tilemaps</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">governors</span> <span class="op">&lt;-</span> <span class="va">governors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>tile_map <span class="op">=</span> <span class="fu"><a href="../reference/generate_map.html">generate_map</a></span><span class="op">(</span><span class="va">geometry</span>, square <span class="op">=</span> <span class="cn">FALSE</span>, flat_topped <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">governors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span>, label <span class="op">=</span> <span class="va">abbreviation</span><span class="op">)</span>,</span>
<span>               fun.geometry <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/generate_map.html">generate_map()</a></code> function requires an object of class
<code>sfc_POLYGON</code> or <code>sfc_MULTIPOLYGON</code> as input. If
the coordinates of the <code>sfc</code> object are in terms of longitude
and latitude, the coordinates will need to be transformed to a planar
projection before creating the tile map. The <code>square</code>
argument controls whether the tiles are squares or hexagons, and the
<code>flat_topped</code> argument controls whether or not hexagons are
flat-topped.</p>
<p>The <code><a href="../reference/generate_map.html">generate_map()</a></code> function only works for contiguous
regions. However, after a tile map has been generated, the
<code><a href="../reference/create_island.html">create_island()</a></code> function can be used to add islands to the
layout of the tile map. The <code><a href="../reference/create_island.html">create_island()</a></code> function takes
two arguments. The first is an <code>sfc_POLYGON</code> object
representing the layout of a tile map, and the second is the position of
the new island tile. The <code>position</code> argument can be specified
as either a numeric vector of length 2 giving the coordinates for the
centroid of the new tile, or a string equal to “upper left”, “lower
left”, “upper right”, or “lower right” indicating in which corner of the
original tile map the new tile should be located. In the following
example, tiles for Alaska and Hawaii are added to the previously
generated tile map.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_states</span> <span class="op">&lt;-</span> <span class="va">governors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>abbreviation <span class="op">=</span> <span class="st">"AK"</span>, party <span class="op">=</span> <span class="st">"Republican"</span>,</span>
<span>          tile_map <span class="op">=</span> <span class="fu"><a href="../reference/create_island.html">create_island</a></span><span class="op">(</span><span class="va">governors</span><span class="op">$</span><span class="va">tile_map</span>, <span class="st">"lower left"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span>abbreviation <span class="op">=</span> <span class="st">"HI"</span>, party <span class="op">=</span> <span class="st">"Democrat"</span>,</span>
<span>          tile_map <span class="op">=</span> <span class="fu"><a href="../reference/create_island.html">create_island</a></span><span class="op">(</span><span class="va">governors</span><span class="op">$</span><span class="va">tile_map</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12050000</span>, <span class="fl">3008338</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_states</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span>, label <span class="op">=</span> <span class="va">abbreviation</span><span class="op">)</span>,</span>
<span>               fun.geometry <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Once a tile map has been created, coloring tiles according to another
variable is simple. In the following code, the states are colored
according to the party affiliation of the governor. This is an example
of a situation where it is useful to use a tile map, instead of a
regular map, because each state has only one governor, regardless of the
area or population of the state.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_states</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span>, fill <span class="op">=</span> <span class="va">party</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">tile_map</span>, label <span class="op">=</span> <span class="va">abbreviation</span><span class="op">)</span>,</span>
<span>               fun.geometry <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Party Affiliation of United States Governors (2020)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-5-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The layout of a tile map can easily be written to a shapefile for
later use or to share with others as follows.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span><span class="va">governors</span><span class="op">$</span><span class="va">tile_map</span>, <span class="st">"us_tilemap.shp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-many-tile-maps">Creating Many Tile Maps<a class="anchor" aria-label="anchor" href="#creating-many-tile-maps"></a>
</h2>
<p>To create and compare more than one tile map, the
<code><a href="../reference/many_maps.html">many_maps()</a></code> function can be used. In the following example,
16 candidate tile maps are generated and plotted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">us_maps</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/many_maps.html">many_maps</a></span><span class="op">(</span><span class="va">governors</span><span class="op">$</span><span class="va">geometry</span>, <span class="va">governors</span><span class="op">$</span><span class="va">abbreviation</span>,</span>
<span>                     prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span>, interpolate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     smoothness <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, shift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The different candidate tile maps are generated by adding sources of
variation at different steps in the algorithm. The <code>prop</code>,
<code>interpolate</code>, <code>smoothness</code>, and
<code>shift</code> arguments control these sources of variation and will
be discussed in more detail later. The total number of maps generated by
the <code><a href="../reference/many_maps.html">many_maps()</a></code> function is the product of the lengths of
each of these arguments. The output of the <code><a href="../reference/many_maps.html">many_maps()</a></code>
function is a data frame in which each row corresponds to one map and
the columns contain the generated maps, the parameters used for creating
the maps, and the costs associated with each map. The data frame is
ordered by the total cost. The different types of costs will be
discussed in more detail later as well. After comparing the tile maps
that were generated, the tile map that the user wishes to use can be
added to the original data frame and plotted.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">governors</span> <span class="op">&lt;-</span> <span class="va">governors</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>square_map <span class="op">=</span> <span class="va">us_maps</span><span class="op">$</span><span class="va">map</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">governors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">square_map</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">square_map</span>, label <span class="op">=</span> <span class="va">abbreviation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The plot of all the candidates maps shown above can be generated
using the <code><a href="../reference/plot_many_maps.html">plot_many_maps()</a></code> function. The function requires
a list of maps, which are of class <code>sfc_POLYGON</code>, and the
labels for the regions of the map. Below is code for how the
<code><a href="../reference/plot_many_maps.html">plot_many_maps()</a></code> function can be used to create the same
plot as before.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_many_maps.html">plot_many_maps</a></span><span class="op">(</span><span class="va">us_maps</span><span class="op">$</span><span class="va">map</span>, <span class="va">governors</span><span class="op">$</span><span class="va">abbreviation</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-algorithm">The Algorithm<a class="anchor" aria-label="anchor" href="#the-algorithm"></a>
</h2>
<p>The four main steps of the algorithm used to generate a tile map are
transforming the region centroids, transforming the boundary, fitting
tiles to the boundary, and assigning regions to tiles. The
<code>prop</code>, <code>interpolate</code>, <code>smoothness</code>,
and <code>shift</code> arguments of the <code><a href="../reference/generate_map.html">generate_map()</a></code> and
<code><a href="../reference/many_maps.html">many_maps()</a></code> functions are used to introduce variation at
different steps in the algorithm, which can lead to different candidate
maps. How each step of the algorithm works and how variation is
introduced will now be discussed in greater detail.</p>
<div class="section level3">
<h3 id="transforming-the-centroids">Transforming the Centroids<a class="anchor" aria-label="anchor" href="#transforming-the-centroids"></a>
</h3>
<p>The first step of the algorithm is to transform the region centroids
so that centroids of neighboring regions are approximately equidistant
but the relative orientation of neighbors is still preserved. The
<code>prop</code> argument can be used at this step of the algorithm to
add variation. Before transforming the original region centroids,
Gaussian noise is added to the position of each centroid. The standard
deviation for the Gaussian noise is defined as a proportion of the mean
distance of a region centroid to its neighbor centroids, and the
<code>prop</code> argument is used to control this proportion. After
noise has been added to the centroids, the centroids are iteratively
updated until they converge. The formula used to update the noisy
centroids is given by McNeill and Hale in <em>“Generating Tile
Maps”</em> (2017).</p>
<p>Before moving to the next step of the algorithm, another source of
variation can be added. Throughout the remaining steps of the algorithm
the fully-transformed centroids can be used, or interpolated centroids
can be used. The interpolated centroids are defined through linear
interpolation between the noisy centroids and fully-transformed
centroids. If straight lines were drawn between the noisy centroids and
fully-transformed centroids, then the interpolated centroids would be
the points at a specified proportion of the distances along the lines.
The <code>interpolate</code> argument controls the proportion. If the
<code>interpolate</code> argument is set equal to 0, then the noisy
centroids would be used in the remaining steps of the algorithm, and if
the <code>interpolate</code> argument is set equal to 1, then the
fully-transformed centroids would be used. If the
<code>interpolate</code> argument is set equal to 0.75, then the points
that are at 75% of the distance between the noisy centroids and
fully-transformed centroids would be used.</p>
<p>Using the same United States dataset as before, the plot below shows
the noisy, interpolated, and fully-transformed centroids when the
<code>prop</code> argument was set equal to 0.1, and the
<code>interpolate</code> argument was set equal to 0.75. Notice that in
the plot the centroids of states in the northeast are being pushed out,
while centroids of states on the west coast are being pulled toward the
center of the map. This results in the centroids of neighboring states
being approximately equidistant. Throughout the remaining steps of the
algorithm, the interpolated centroids will be used.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="transforming-the-boundary">Transforming the Boundary<a class="anchor" aria-label="anchor" href="#transforming-the-boundary"></a>
</h3>
<p>The next step of the algorithm is to transform the boundary of the
map based on the new centroids. The boundary is pulled in toward the new
centroids if the boundary is more than the estimated tile size away from
the centroids, and the boundary is pushed away from the new centroids if
the boundary is less than the estimated tile size away from the
centroids. At this step, the boundary of the map is first converted to a
set of points, and then a sample of approximately 1,000 points is taken
from that set. The sampled boundary points are transformed according to
the formula given in <em>“Generating Tile Maps”</em> (McNeill and Hale
2017). After the sample boundary points have been transformed, they are
then converted to a polygon. To introduce variation at this step in the
algorithm, the transformed boundary can be smoothed. The
<code><a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth()</a></code> function from the <code>smoothr</code> package is
used to perform kernel smoothing of the boundary. How much the boundary
is smoothed is controlled by the <code>smoothness</code> argument. The
<code><a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth()</a></code> function calculates the bandwidth of the Gaussian
kernel used for smoothing as the mean distance between adjacent points,
and the bandwidth is then multiplied by the value given for the
<code>smoothness</code> argument. The greater the value of the
<code>smoothness</code> argument, the more smooth the boundary will
become. Below is a plot with the transformed and smoothed boundaries of
the United States with the <code>smoothness</code> argument set equal to
20. Notice that the transformed boundary is now outside the original
boundary around the northeast and the transformed boundary is within the
original boundary along the west coast. For the remaining steps of the
algorithm, the smoothed boundary will be used.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="fitting-tiles-to-the-boundary">Fitting Tiles to the Boundary<a class="anchor" aria-label="anchor" href="#fitting-tiles-to-the-boundary"></a>
</h3>
<p>The third step of the algorithm is to fit tiles inside the
transformed boundary. This is done by first creating a grid of tiles
that covers the bounding box of the transformed polygon. The size of the
tiles is estimated by first finding the total area of the map, dividing
it by the number of regions, and then taking the square root. After
creating the initial grid, the number of tile centroids that are inside
the transformed boundary is found. Depending on whether the number of
tile centroids inside the boundary is greater than or less than the
number of regions in the map, the tile size is either increased or
decreased, and then a new grid of tiles is created. This process is
repeated until the correct number of tile centroids are within the
transformed boundary. Variation can also be added at this step by
shifting the grid of tiles before counting the number of tile centroids
that lie within the transformed boundary. The <code>shift</code>
argument is a numeric vector of length two for the
<code><a href="../reference/generate_map.html">generate_map()</a></code> function or a list of numeric vectors of
length two for the <code><a href="../reference/many_maps.html">many_maps()</a></code> function. The first value of
the vector determines the amount to shift in the x direction and the
second value determines the amount to shift in the y direction. The
values given in the vector are multiplied by the tile size, and the
resulting value is the amount that the grid is shifted. For example if
<code>c(0.5,0.5)</code> was given for the shift argument in the
<code><a href="../reference/generate_map.html">generate_map()</a></code> function, then the grid of tiles would be
shifted by half a tile in both the x and y directions. In the final step
of the algorithm, a square grid, which was shifted by half a tile in
each direction, will be used.</p>
</div>
<div class="section level3">
<h3 id="assigning-regions-to-tiles">Assigning Regions to Tiles<a class="anchor" aria-label="anchor" href="#assigning-regions-to-tiles"></a>
</h3>
<p>To complete the tile map, the regions of the original map must be
assigned to the tiles of the tile map. The assignment of regions to
tiles is chosen to minimize the sum of the squared distances between
transformed region centroids and the assigned tile centroids. This an
example of the well-known linear sum assignment problem. This problem
can be solved using an algorithm known as the Hungarian method, which
was first developed by Harold Kuhn (1955). A plot of the resulting tile
map is shown below.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="calculating-costs">Calculating Costs<a class="anchor" aria-label="anchor" href="#calculating-costs"></a>
</h3>
<p>In <em>“Generating Tile Maps”</em> (2017), McNeill and Hale describe
four different cost functions that can be used to compare tile maps. The
first is a location cost, which is the mean distance between the
transformed centroids and tile centroids divided by the tile size. The
next cost is an adjacency cost, which is the mean of the proportion of
neighbors that each region is missing. The relative orientation cost is
a measure of how much the angles between centroids of neighboring
regions change. First the mean change in angles between a region
centroid and its neighboring centroids is found for each region. Then
the final relative orientation cost is the mean of the means of the
regions. The final cost is a roughness cost. This cost is based on how
many edges in the tile map are shared edges. These four costs can be
combined into one total cost as a weighted sum. The data frame output by
the <code><a href="../reference/many_maps.html">many_maps()</a></code> function includes columns for each of the
costs, and the <code>weights</code> argument can be used to control the
weight for each cost when calculating the total cost.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Kuhn, Harold W. 1955. “The Hungarian Method for the Assignment
Problem.” <em>Naval Research Logistics Quarterly</em> 2 (1-2). Wiley
Online Library: 83–97.</p>
<p>McNeill, Graham, and Scott A Hale. 2017. “Generating Tile Maps.” In
<em>Computer Graphics Forum</em>, 36:435–45. 3. Wiley Online
Library.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kaelyn Rosenberg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
